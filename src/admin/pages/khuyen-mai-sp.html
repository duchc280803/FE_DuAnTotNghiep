<div class="card overflow-hidden" style="min-height: 120px">
  <h5 style="padding-left: 20px; padding-top: 16px; margin-bottom: 0">
    <img src="/assets/images/filter-filled-tool-symbol.png" width="20px" style="padding-right: 3px" />Bộ lọc
  </h5>
  <hr />
  <div class="box">
    <div class="row" style="padding: 10px">
      <div class="col-md-4">
        <input class="form-control" ng-model="key2" ng-change="searchbyMa()" placeholder="Mã khuyến mại"
          style="margin-top: 4px" />
      </div>
      <div class="col-md-4">
        <input class="form-control" ng-model="key" placeholder="Tên khuyến mại" style="margin-top: 4px"
          ng-change="searchKey()" />
      </div>
      <div class="col-md-4 d-flex justify-content-start" style="text-align: end">
        <label class="form-label" style="margin-top: 11px">Trạng thái :</label>
        <select style="color: green" class="custom-select" ng-model="key3" ng-change="searchStatus()">
          <option value="">Tất cả</option>
          <option value="1">Còn Hiệu Lực </option>
          <option value="2">Hết Hiệu Lực</option>
        </select>
      </div>
    </div>
    <!-- Thêm vào mục "Bộ lọc" -->
    <div class="row" style="padding: 10px">
      <div class="col-md-6">
        <input type="date" class="form-control" ng-model="startDate" style="margin-top: 4px" />
      </div>
      <div class="col-md-6">
        <input type="date" class="form-control" ng-model="endDate" style="margin-top: 4px" />
      </div>
      <div class="col-md-6">
        <button class="btn btn-primary" ng-click="searchGiamGia()" style="margin-top: 10px">
          Tìm kiếm
        </button>
      </div>
    </div>

    <div class="row" style="padding: 10px">
      <div class="col-md-6"></div>
      <div class="col-md-6" style="padding-left: 320px">
        <button class="btn btn-outline-primary m-1" ng-click="refresh()">
          Làm mới
        </button>
        <a href="#/promotion/create" class="btn btn-outline-primary m-1">
          <span style="vertical-align: middle">Tạo Khuyến Mại</span>
        </a>
      </div>
      <div class="col-md-3" style="margin-top: 40px; margin-bottom: 10px">
        <a href="#/promotion/history" class="btn btn-danger" style="text-decoration: none; height: 39px">
          <span style="vertical-align: middle" class="hide-menu">Lịch sử thao tác</span>
        </a>
      </div>
    </div>
  </div>
</div>
<div class="row">
  <div class="col-lg-6">
    <h5>
      <img src="/assets/images/list.png" width="20px" style="padding-right: 3px; vertical-align: middle" />Danh
      sách khuyến mại
    </h5>
  </div>
  <div class="col-lg-6"></div>
</div>
<div class="card overflow-hidden">
  <div class="box">
    <table class="table">
      <thead>
        <tr style="background-color: lightskyblue">
          <th scope="col">STT</th>
          <th scope="col">Mã khuyến mại</th>
          <th scope="col">Tên khuyến mại</th>
          <th scope="col">Giảm giá</th>
          <th scope="col" style="padding-left: 155px;">Thời gian</th>
          <th scope="col">Trạng Thai</th>
          <th scope="col" style="width: 220px;">Thao Tác</th>
        </tr>
      </thead>
      <tbody class="table">
        <tr ng-repeat="gg in listGiamGia">
          <td>{{$index + 1}}</td>
          <td>{{gg.maGiamGia}}</td>
          <td>{{gg.tenGiamGia}}</td>
          <td>{{gg.mucGiam}}{{gg.hinhThucGiam == 1 ? 'đ' : '%'}}</td>
          <td>
            {{gg.ngayBatDau | date:'dd/MM/yyyy HH:mm:ss a'}} - {{gg.ngayKetThuc | date:'dd/MM/yyyy HH:mm:ss a'}}
          </td>
          <td>
            {{gg.trangThai == 1 ? 'Còn hạn':'Hết hạn'}}
          </td>
          <td>
            <a class="btn btn-primary" ng-click="toggleDetail(gg)" data-toggle="modal"
              data-target="#detailsModal{{$index}}">
              <img src="/assets/images/loupe.png" width="25px" alt="">
            </a>
            <a href="#/promotion/update/{{gg.id}}" class="btn btn-primary" ng-click="goToUpdatePage({{gg.id}})"><img
                src="/assets/images/update.png" width="25px" alt=""></a>
            <a class="btn btn-primary" ng-click="updateGiamGiaStatus(gg.id, $event)">
              <img src="/assets/images/disabled.png" width="25px" alt="">
            </a>
            <!-- Details Modal -->
            <div class="modal fade" id="detailsModal{{$index}}" tabindex="-1" role="dialog"
              aria-labelledby="detailsModalLabel{{$index}}" aria-hidden="true">
              <div class="modal-dialog" role="document">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="detailsModalLabel{{$index}}">Chi Tiết Sản Phẩm</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body" ng-show="gg.showDetail">
                    <!-- Display details here -->
                    <table class="table table-hover">
                      <thead>
                        <tr style="background-color: lightskyblue">
                          <th scope="col">STT</th>
                          <th scope="col">Tên sản phẩm</th>
                          <th scope="col">Giá bán</th>
                          <th scope="col">Giá giảm</th>
                        </tr>
                      </thead>
                      <tbody class="table">
                        <tr ng-repeat="detail in gg.detailList">
                          <td>{{$index + 1}}</td>
                          <td>{{detail.productName}}</td>
                          <td>{{detail.giaBan}}</td>
                          <td>{{detail.donGiaKhiGiam}}</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
    <div class="col-lg-12">
      <nav aria-label="Page navigation example" style="margin-left: 400px">
        <ul class="pagination">
          <li class="page-item">
            <a class="page-link" ng-href="#/khuyen-mai?page={{page - 1}}" ng-click="previousPage()">Previous</a>
          </li>
          <li class="page-item" ng-repeat="page in getPageNumbers()">
            <a class="page-link" ng-href="#/khuyen-mai?page={{page}}" ng-click="updatePage(page)">{{ page }}</a>
          </li>
          <li class="page-item">
            <a class="page-link" ng-href="#/khuyen-mai?page={{page + 1}}" ng-click="nextPage()">Next</a>
          </li>
        </ul>
      </nav>
    </div>
    <table class="table">
      <thead>
        <tr style="background-color: antiquewhite">
          <th scope="col">
            <input type="checkbox" style="margin-right: 15px" ng-model="selectAllProducts"
              ng-change="toggleAllProducts()" />
            {{$index + 1}}
          </th>
          <th scope="col">Ảnh sản phẩm</th>
          <th scope="col">Tên sản phẩm</th>
          <th scope="col">Đơn giá</th>
          <th scope="col">Số lượng Giảm giá</th>
          <th scope="col">Giá sau giảm</th>
        </tr>
      </thead>
      <tbody class="table">
        <tr ng-repeat="gg in listProduct">
          <td style="padding-top: 75px">
            <input type="checkbox" style="margin-right: 15px" ng-model="selectedProductIds[gg.id]"
              ng-change="chonSanPham(gg.id)" ng-checked="selectAllProducts" />
            {{$index + 1}}
          </td>
          <td>
            <img src="{{gg.image}}" alt="" width="150px" />
          </td>
          <td>{{gg.productName}}</td>
          <td>
            {{gg.giaBan | number}}₫
          </td>
          <td>
            {{gg.soLanGiam}}
          </td>
          <td>
            {{gg.giaBan - gg.giaGiam | number}}₫
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>